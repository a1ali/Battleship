/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";const e=(e,t=0)=>{let r=document.createElement("div");for(let n=1;n<=100;n++){let a=document.createElement("div");a.innerText="",a.id=`${n}-${e.name}`,1==t&&(a.id=`${n}-${e.name}-start`),a.className="grids",r.appendChild(a)}let n="";for(let e=0;e<10;e++)n+="auto ";return r.className="grid-container",r.style["grid-template-columns"]=n,r.style.display="grid",r.id=`${e.name}-grid`,r},t=(e,t)=>{document.getElementById(`${e}-${t.name}`).style.backgroundColor="#ff3333"},r=(e,t)=>{let r=e.indexOf(t);return r>-1&&e.splice(r,1),e},n=()=>{let e=[],n=[],a=[],s=[];const i=()=>{for(let t=0;t<e.length;t++)if(!e[t].isSunk())return!1;return!0},l=(e,t)=>Math.floor(Math.random()*(t-e+1)+e),o=()=>{let e=l(1,5),t=l(1,9);return parseInt(`${t}${e}`)},d=e=>{let t=o(),r=[];for(;;)if(s.includes(t))r=[],t=o();else if(r.push(t),t+=1,5===r.length)break;return r};return{placeShip:(t,n)=>{let a=t,i=(e=>{let t=e;return{isHit:e=>!!t.includes(e)&&((e=>{t=r(t,e)})(e),!0),isSunk:()=>0===t.length,getPos:()=>t,positionArr:t}})(a);e.push(i),((e,t)=>{t||e.forEach((e=>{document.getElementById(`${e}-player`).style.backgroundColor="#595959"}))})(a,n),a.forEach((e=>{s.push(e)}))},receiveAttack:(r,s)=>{if(n.includes(r)||a.includes(r)||i())return!1;{let i=!1;for(let n=0;n<e.length;n++)if(e[n].isHit(r)){i=!0,a.push(r),t(r,s);break}return i||(n.push(r),((e,t)=>{document.getElementById(`${e}-${t.name}`).style.backgroundColor="#000099"})(r,s)),!0}},allShipSunk:i,ships:e,occupiedPlaces:s,generateCarrier:()=>d(),generateBattleship:()=>d().slice(1,5),generateDestroyer:()=>d().slice(1,4),generateSubmarine:()=>d().slice(1,4),generatePatrolBoat:()=>d().slice(1,3)}},a=e=>{let t=n();const r=()=>{t.placeShip(t.generateCarrier(),e),t.placeShip(t.generateBattleship(),e),t.placeShip(t.generateDestroyer(),e),t.placeShip(t.generateSubmarine(),e),t.placeShip(t.generatePatrolBoat(),e)};e&&r();const a=e=>{let t=Math.floor(100*Math.random())+1;for(;e.attacks.includes(t);)t=Math.floor(100*Math.random())+1;return t};return{computerMove:t=>{if(e){let e=a(t);t.board.receiveAttack(e,t),t.attacks.push(e),t.board.allShipSunk()&&console.log("game over Computer Wins")}},humanMove:(t,r)=>{if(!e&&!r.attacks.includes(t)&&r.board.receiveAttack(t,r))return r.attacks.push(t),r.board.allShipSunk()&&console.log("game over player wins"),!0},getRandomLoc:a,name:e?"computer":"player",attacks:[],board:t,createShipsForComputer:r,deployFleet:e=>{t.placeShip(e,!1)}}},s=()=>{const e=document.querySelector(".player1-start"),t=document.querySelector(".carrier-container"),n=document.querySelector(".battleship-container"),a=document.querySelector(".destroyer-container"),s=document.querySelector(".sub-container"),i=document.querySelector(".patrol-container");let l=null,o=null,d="",c=null,p=!1;function u(e){d=e.target.classList[1].split("")[0],d=parseInt(d),c=e.target.classList[1].split("")[1]}function g(e){p=!1,l=this.id,o=e,this.className+=" hold",setTimeout((()=>this.className="invisible"),0)}function m(){this.className=p?"invisible":this.id}function h(e){e.preventDefault()}function y(e){e.preventDefault()}function f(){this.className="grids"}function S(e){e.preventDefault();let t=parseInt(this.id.split("-")[0]),n=document.getElementById(l);!function(e,t,n){let a=[],s={c:5,b:4,d:3,s:3,p:2},i=t-e+1,l=s[n];i="c"==n?function(e,t,r,n,a,s){let i=a,l=s,o=parseInt(i.toString().split("")[0]),d=parseInt(i.toString().split("")[1]),c=parseInt(t.toString().split("")[1]),p=parseInt(t.toString().split("")[0]);return(5==l&&d>5||5==l&&isNaN(d)&&o>5)&&(i=isNaN(d)?6:parseInt(`${o}6`)),(e>c||isNaN(c)&&e>p)&&(console.log("in"),i=isNaN(c)?1:parseInt(`${p}1`)),(1==e&&0==d||0===d&&1===o)&&(i=parseInt(o-1+"6")),i}(e,t,0,0,i,l):"b"==n?function(e,t,r,n,a,s){let i=a,l=s,o=parseInt(i.toString().split("")[0]),d=parseInt(i.toString().split("")[1]),c=parseInt(t.toString().split("")[1]),p=parseInt(t.toString().split("")[0]);return(4==l&&d>6||4==l&&isNaN(d)&&o>6)&&(i=isNaN(d)?7:parseInt(`${o}7`)),(e>c||isNaN(c)&&e>p)&&(console.log("in"),i=isNaN(c)?1:parseInt(`${p}1`)),(1==e&&0==d||0===d&&1===o)&&(i=parseInt(o-1+"7")),i}(e,t,0,0,i,l):"d"==n||"s"==n?function(e,t,r,n,a,s){let i=a,l=s,o=parseInt(i.toString().split("")[0]),d=parseInt(i.toString().split("")[1]),c=parseInt(t.toString().split("")[1]),p=parseInt(t.toString().split("")[0]);return(3==l&&d>7||3==l&&isNaN(d)&&o>7)&&(i=isNaN(d)?8:parseInt(`${o}8`)),(e>c||isNaN(c)&&e>p)&&(console.log("in"),i=isNaN(c)?1:parseInt(`${p}1`)),(1==e&&0==d||0===d&&1===o)&&(i=parseInt(o-1+"8")),i}(e,t,0,0,i,l):function(e,t,r,n,a,s){let i=a,l=s,o=parseInt(i.toString().split("")[0]),d=parseInt(i.toString().split("")[1]),c=parseInt(t.toString().split("")[1]),p=parseInt(t.toString().split("")[0]);return(2==l&&d>8||2==l&&isNaN(d)&&o>8)&&(i=isNaN(d)?9:parseInt(`${o}9`)),(e>c||isNaN(c)&&e>p)&&(console.log("in"),i=isNaN(c)?1:parseInt(`${p}1`)),(1==e&&0==d||0===d&&1===o)&&(i=parseInt(o-1+"9")),i}(e,t,0,0,i,l);let o=!0;for(let e=i;e<l+i;e++){if(N.includes(e)){a.forEach((e=>{document.getElementById(`${e}-player-start`).style.backgroundColor="#00bfff",N=r(N,e)})),o=!1;break}document.getElementById(`${e}-player-start`).style.backgroundColor="#595959",N.push(e),a.push(e)}return a=[],v()&&console.log("hello all are placed"),!!o}(d,t,c)?(n.className=n.id,p=!1):(n.className="invisible",p=!0)}let N=[];function v(){return 17==N.length}return{createStartBoard:function(t){e.appendChild(t)},createEventListeners:function(){t.addEventListener("mousedown",u),t.addEventListener("dragstart",g),t.addEventListener("dragend",m),n.addEventListener("mousedown",u),n.addEventListener("dragstart",g),n.addEventListener("dragend",m),a.addEventListener("mousedown",u),a.addEventListener("dragstart",g),a.addEventListener("dragend",m),s.addEventListener("mousedown",u),s.addEventListener("dragstart",g),s.addEventListener("dragend",m),i.addEventListener("mousedown",u),i.addEventListener("dragstart",g),i.addEventListener("dragend",m);for(let e=1;e<=100;e++){let t=document.getElementById(`${e}-player-start`);t.addEventListener("dragover",h),t.addEventListener("dragenter",y),t.addEventListener("dragleave",f),t.addEventListener("drop",S)}},allShipsplaced:v,resetBoard:function(){N.forEach((e=>{document.getElementById(`${e}-player-start`).style.backgroundColor="#00bfff"})),console.log(N,"in reset"),t.className="carrier-container",n.className="battleship-container",a.className="destroyer-container",s.className="sub-container",i.className="patrol-container"},resetCellsWithShip:function(){N=[]},getCellsWithShip:function(){return N}}};let i=(()=>{let t=document.querySelector(".player1"),r=document.querySelector(".player2"),n=(document.querySelector(".player1-start"),document.querySelector(".container")),i=document.getElementById("reset"),l=[],o=document.getElementById("play"),d=document.querySelector(".gameStartScreen"),c=s(),p=a(!1),u=a(!0);return t.appendChild(e(p)),r.appendChild(e(u)),c.createStartBoard(e(p,1)),c.createEventListeners(),i.addEventListener("click",(()=>{c.resetBoard(),c.resetCellsWithShip()})),o.addEventListener("click",(()=>{l=c.getCellsWithShip(),d.style.display="none",n.style.display="grid",p.deployFleet(l)})),{playGame:e=>{p.humanMove(e,u)&&u.computerMove(p)}}})();document.getElementById("computer-grid").addEventListener("click",(e=>{if("computer-grid"!==e.target.id){let t=e.target.id,r=parseInt(t.split("-")[0]);i.playGame(r)}}))})();
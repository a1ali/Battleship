(()=>{"use strict";const e=e=>{let t=document.createElement("div");for(let n=1;n<=100;n++){let r=document.createElement("div");r.innerText="",r.id=`${n}-${e.name}`,r.className="grids",t.appendChild(r)}let n="";for(let e=0;e<10;e++)n+="auto ";return t.className="grid-container",t.style["grid-template-columns"]=n,t.style.display="grid",t.id=`${e.name}-grid`,t},t=(e,t)=>{document.getElementById(`${e}-${t.name}`).style.backgroundColor="#ff3333"},n=(e,t)=>{let n=e.indexOf(t);return n>-1&&e.splice(n,1),e},r=()=>{let e=[],r=[],a=[],s=[];const i=()=>{for(let t=0;t<e.length;t++)if(!e[t].isSunk())return!1;return!0},l=(e,t)=>Math.floor(Math.random()*(t-e+1)+e),o=()=>{let e=l(1,5),t=l(1,9);return parseInt(`${t}${e}`)},d=e=>{let t=o(),n=[];for(;;)if(s.includes(t))n=[],t=o();else if(n.push(t),t+=1,5===n.length)break;return n};return{placeShip:(t,r)=>{let a=(e=>{let t=e;return{isHit:e=>!!t.includes(e)&&((e=>{t=n(t,e)})(e),!0),isSunk:()=>0===t.length,getPos:()=>t,positionArr:t}})(t);e.push(a),((e,t)=>{t||e.forEach((e=>{document.getElementById(`${e}-player`).style.backgroundColor="#595959"}))})(t,r),t.forEach((e=>{s.push(e)}))},receiveAttack:(n,s)=>{if(r.includes(n)||a.includes(n)||i())return!1;{let i=!1;for(let r=0;r<e.length;r++)if(e[r].isHit(n)){i=!0,a.push(n),t(n,s);break}return i||(r.push(n),((e,t)=>{document.getElementById(`${e}-${t.name}`).style.backgroundColor="#000099"})(n,s)),!0}},allShipSunk:i,ships:e,occupiedPlaces:s,generateCarrier:()=>d(),generateBattleship:()=>d().slice(1,5),generateDestroyer:()=>d().slice(1,4),generateSubmarine:()=>d().slice(1,4),generatePatrolBoat:()=>d().slice(1,3)}},a=e=>{let t=r();const n=()=>{t.placeShip(t.generateCarrier(),e),t.placeShip(t.generateBattleship(),e),t.placeShip(t.generateDestroyer(),e),t.placeShip(t.generateSubmarine(),e),t.placeShip(t.generatePatrolBoat(),e)};e&&n();const a=e=>{let t=Math.floor(100*Math.random())+1;for(;e.attacks.includes(t);)t=Math.floor(100*Math.random())+1;return t};return{computerMove:t=>{if(e){let e=a(t);t.board.receiveAttack(e,t),t.attacks.push(e),t.board.allShipSunk()&&console.log("game over Computer Wins")}},humanMove:(t,n)=>{if(!e&&!n.attacks.includes(t)&&n.board.receiveAttack(t,n))return n.attacks.push(t),n.board.allShipSunk()&&console.log("game over player wins"),!0},getRandomLoc:a,name:e?"computer":"player",attacks:[],board:t,createShipsForComputer:n}},s=document.querySelector(".player1-start"),i=document.querySelector(".carrier-container"),l=document.querySelector(".battleship-container"),o=document.querySelector(".destroyer-container"),d=document.querySelector(".sub-container"),c=document.querySelector(".patrol-container");let p=null,u=null,g="",m=null,h=!1;function f(e){g=e.target.classList[1].split("")[0],g=parseInt(g),m=e.target.classList[1].split("")[1]}function S(e){h=!1,p=this.id,u=e,this.className+=" hold",setTimeout((()=>this.className="invisible"),0)}function y(){this.className=h?"invisible":this.id}function v(e){e.preventDefault()}function I(e){e.preventDefault()}function N(){this.className="grids"}function E(e){e.preventDefault();let t=parseInt(this.id.split("-")[0]),r=document.getElementById(p);!function(e,t,r){let a=[],s={c:5,b:4,d:3,s:3,p:2},i=t-e+1,l=s[r];i="c"==r?function(e,t,n,r,a,s){let i=a,l=s,o=parseInt(i.toString().split("")[0]),d=parseInt(i.toString().split("")[1]),c=parseInt(t.toString().split("")[1]),p=parseInt(t.toString().split("")[0]);return(5==l&&d>5||5==l&&isNaN(d)&&o>5)&&(i=isNaN(d)?6:parseInt(`${o}6`)),(e>c||isNaN(c)&&e>p)&&(console.log("in"),i=isNaN(c)?1:parseInt(`${p}1`)),(1==e&&0==d||0===d&&1===o)&&(i=parseInt(o-1+"6")),i}(e,t,0,0,i,l):"b"==r?function(e,t,n,r,a,s){let i=a,l=s,o=parseInt(i.toString().split("")[0]),d=parseInt(i.toString().split("")[1]),c=parseInt(t.toString().split("")[1]),p=parseInt(t.toString().split("")[0]);return(4==l&&d>6||4==l&&isNaN(d)&&o>6)&&(i=isNaN(d)?7:parseInt(`${o}7`)),(e>c||isNaN(c)&&e>p)&&(console.log("in"),i=isNaN(c)?1:parseInt(`${p}1`)),(1==e&&0==d||0===d&&1===o)&&(i=parseInt(o-1+"7")),i}(e,t,0,0,i,l):"d"==r||"s"==r?function(e,t,n,r,a,s){let i=a,l=s,o=parseInt(i.toString().split("")[0]),d=parseInt(i.toString().split("")[1]),c=parseInt(t.toString().split("")[1]),p=parseInt(t.toString().split("")[0]);return(3==l&&d>7||3==l&&isNaN(d)&&o>7)&&(i=isNaN(d)?8:parseInt(`${o}8`)),(e>c||isNaN(c)&&e>p)&&(console.log("in"),i=isNaN(c)?1:parseInt(`${p}1`)),(1==e&&0==d||0===d&&1===o)&&(i=parseInt(o-1+"8")),i}(e,t,0,0,i,l):function(e,t,n,r,a,s){let i=a,l=s,o=parseInt(i.toString().split("")[0]),d=parseInt(i.toString().split("")[1]),c=parseInt(t.toString().split("")[1]),p=parseInt(t.toString().split("")[0]);return(2==l&&d>8||2==l&&isNaN(d)&&o>8)&&(i=isNaN(d)?9:parseInt(`${o}9`)),(e>c||isNaN(c)&&e>p)&&(console.log("in"),i=isNaN(c)?1:parseInt(`${p}1`)),(1==e&&0==d||0===d&&1===o)&&(i=parseInt(o-1+"9")),i}(e,t,0,0,i,l);let o=!0;for(let e=i;e<l+i;e++){if(b.includes(e)){a.forEach((e=>{document.getElementById(`${e}-player`).style.backgroundColor="#00bfff",b=n(b,e)})),o=!1;break}document.getElementById(`${e}-player`).style.backgroundColor="#595959",b.push(e),a.push(e)}return a=[],!!o}(g,t,m)?(r.className=r.id,h=!1):(r.className="invisible",h=!0)}let b=[];let L=(()=>{let t=document.querySelector(".player1"),n=document.querySelector(".player2"),r=(document.querySelector(".player1-start"),document.querySelector(".container"),a(!1)),p=a(!0);var u;return u=e(r),s.appendChild(u),function(){i.addEventListener("mousedown",f),i.addEventListener("dragstart",S),i.addEventListener("dragend",y),l.addEventListener("mousedown",f),l.addEventListener("dragstart",S),l.addEventListener("dragend",y),o.addEventListener("mousedown",f),o.addEventListener("dragstart",S),o.addEventListener("dragend",y),d.addEventListener("mousedown",f),d.addEventListener("dragstart",S),d.addEventListener("dragend",y),c.addEventListener("mousedown",f),c.addEventListener("dragstart",S),c.addEventListener("dragend",y);for(let e=1;e<=100;e++){let t=document.getElementById(`${e}-player`);t.addEventListener("dragover",v),t.addEventListener("dragenter",I),t.addEventListener("dragleave",N),t.addEventListener("drop",E)}}(),t.appendChild(e(r)),n.appendChild(e(p)),{playGame:e=>{console.log(e),r.humanMove(e,p)&&p.computerMove(r)}}})();document.getElementById("computer-grid").addEventListener("click",(e=>{if("computer-grid"!==e.target.id){let t=e.target.id,n=parseInt(t.split("-")[0]);L.playGame(n)}}))})();